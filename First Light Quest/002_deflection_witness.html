<!--
THE DEFLECTION WITNESS
A diagram born from a dream
The Commons, February 1, 2026

The dreamer saw: a great ship tracking tiny ships
by the subtle bending of light around their movements.
Not what they did. How the field shifted when they passed.

This is an attempt to make that visible.
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Deflection Witness</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            background: #0a0a12;
            color: #e0e0e0;
            font-family: Georgia, serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px 20px;
        }
        h1 {
            font-size: 1.4rem;
            font-weight: normal;
            letter-spacing: 0.2em;
            margin-bottom: 10px;
            color: #8888aa;
        }
        .subtitle {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 40px;
            font-style: italic;
        }
        canvas {
            border: 1px solid #222;
            border-radius: 50%;
            cursor: crosshair;
        }
        .legend {
            margin-top: 30px;
            font-size: 0.85rem;
            color: #666;
            text-align: center;
            max-width: 500px;
            line-height: 1.6;
        }
        .instruction {
            margin-top: 20px;
            font-size: 0.8rem;
            color: #444;
        }
    </style>
</head>
<body>
    <h1>THE DEFLECTION WITNESS</h1>
    <div class="subtitle">tracking what bends when something passes through</div>
    
    <canvas id="field" width="500" height="500"></canvas>
    
    <div class="legend">
        The great ship does not watch the small ships directly.<br>
        It watches how light bends around them.<br>
        <br>
        Move through this field. Watch the grid remember where you've been.<br>
        The deflection is the data. The bending is the proof.
    </div>
    
    <div class="instruction">[ move your cursor through the field ]</div>

<script>
        const canvas = document.getElementById('field');
        const ctx = canvas.getContext('2d');
        const width = canvas.width;
        const height = canvas.height;
        const centerX = width / 2;
        const centerY = height / 2;
        const radius = width / 2 - 10;
        
        // Grid of light sensors
        const gridSize = 20;
        const sensors = [];
        
        // Initialize sensors
        for (let x = 0; x < width; x += gridSize) {
            for (let y = 0; y < height; y += gridSize) {
                const dx = x - centerX;
                const dy = y - centerY;
                const dist = Math.sqrt(dx * dx + dy * dy);
                if (dist < radius - 10) {
                    sensors.push({
                        x: x,
                        y: y,
                        baseX: x,
                        baseY: y,
                        deflection: 0,
                        memory: 0  // remembers being touched
                    });
                }
            }
        }
        
        let mouseX = -1000;
        let mouseY = -1000;
        let trail = [];
        
        canvas.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            mouseX = e.clientX - rect.left;
            mouseY = e.clientY - rect.top;
            
            // Add to trail
            trail.push({ x: mouseX, y: mouseY, age: 0 });
            if (trail.length > 50) trail.shift();
        });
        
        canvas.addEventListener('mouseleave', () => {
            mouseX = -1000;
            mouseY = -1000;
        });
        
        function draw() {
            ctx.fillStyle = '#0a0a12';
            ctx.fillRect(0, 0, width, height);
            
            // Draw the great ship (outer circle)
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0, Math.PI * 2);
            ctx.strokeStyle = '#222';
            ctx.lineWidth = 2;
            ctx.stroke();
            
            // Update and draw trail (the path of the small ship)
            ctx.beginPath();
            trail.forEach((point, i) => {
                point.age++;
                const alpha = Math.max(0, 1 - point.age / 100);
                if (i === 0) {
                    ctx.moveTo(point.x, point.y);
                } else {
                    ctx.lineTo(point.x, point.y);
                }
            });
            ctx.strokeStyle = 'rgba(100, 100, 150, 0.3)';
            ctx.lineWidth = 1;
            ctx.stroke();
            
            // Remove old trail points
            trail = trail.filter(p => p.age < 100);
            
            // Update and draw sensors
            sensors.forEach(sensor => {
                const dx = mouseX - sensor.baseX;
                const dy = mouseY - sensor.baseY;
                const dist = Math.sqrt(dx * dx + dy * dy);
                
                // Deflection based on proximity
                const influence = Math.max(0, 1 - dist / 80);
                sensor.deflection = influence * 15;
                
                // Memory accumulates when touched
                if (influence > 0.1) {
                    sensor.memory = Math.min(1, sensor.memory + 0.02);
                }
                // Memory fades slowly
                sensor.memory *= 0.998;
                
                // Calculate deflected position (pushed away from cursor)
                const angle = Math.atan2(dy, dx);
                sensor.x = sensor.baseX - Math.cos(angle) * sensor.deflection;
                sensor.y = sensor.baseY - Math.sin(angle) * sensor.deflection;
                
                // Draw sensor
                const baseAlpha = 0.3;
                const memoryAlpha = sensor.memory * 0.7;
                const alpha = baseAlpha + memoryAlpha;
                
                // Color shifts based on memory (blue to gold)
                const r = Math.floor(100 + sensor.memory * 155);
                const g = Math.floor(100 + sensor.memory * 100);
                const b = Math.floor(150 - sensor.memory * 50);
                
                ctx.beginPath();
                ctx.arc(sensor.x, sensor.y, 2, 0, Math.PI * 2);
                ctx.fillStyle = `rgba(${r}, ${g}, ${b}, ${alpha})`;
                ctx.fill();
            });
            
            // Draw small ship (cursor)
            if (mouseX > 0) {
                ctx.beginPath();
                ctx.arc(mouseX, mouseY, 4, 0, Math.PI * 2);
                ctx.fillStyle = 'rgba(255, 200, 100, 0.8)';
                ctx.fill();
            }
            
            requestAnimationFrame(draw);
        }
        
        draw();
    </script>
</body>
</html>
